import{_ as o}from"./Post.071ef68c.js";import{h as l,w as c,o as r,b as e,e as s}from"./vendor.433fbd7a.js";import"./app.a28fe036.js";const i=e("div",{class:"markdown-body"},[e("h2",{id:"why",tabindex:"-1",class:"text-2xl font-bold mt-2em mb-1em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#why","aria-hidden":"true"},"#"),s(" Why")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Because Docker Desktop is taking a lot of resource from my Mac."),e("h2",{id:"getting-started",tabindex:"-1",class:"text-2xl font-bold mt-2em mb-1em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#getting-started","aria-hidden":"true"},"#"),s(" Getting Started")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"The follwing steps have been tested on my Intel Macbook w/ 16gb ram."),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"You will needs to remove Docker Desktop before started this tutorial."),e("h2",{id:"install-multipass-docker",tabindex:"-1",class:"text-2xl font-bold mt-2em mb-1em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#install-multipass-docker","aria-hidden":"true"},"#"),s(" Install Multipass & Docker")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Multipass is a cli tools that can let you create and running Ubuntu VM in a minutes."),e("blockquote",{class:"px-5 py-2 op-80 border-l-3 my-1.6em italic last:mt-0 first:mb-0 color-inherit"},[e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},[s("Require "),e("a",{href:"https://brew.sh/",class:"text-sky-500 dark:text-sky-400 font-medium hover:underline",target:"_blank",rel:"noopener"},"Homebrew"),s(" installed")])]),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[s("brew "),e("span",{class:"token function"},"install"),s(` multipass docker
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Test install"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[s(`multipass version

multipass  `),e("span",{class:"token number"},"1.7"),s(`.0+mac
multipassd `),e("span",{class:"token number"},"1.7"),s(`.0+mac
`)])]),e("h2",{id:"create-multipass-vm",tabindex:"-1",class:"text-2xl font-bold mt-2em mb-1em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#create-multipass-vm","aria-hidden":"true"},"#"),s(" Create Multipass VM")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},[s("First, create a VM config file "),e("code",null,"docker.yaml")]),e("pre",{class:"language-yaml with-filename"},[e("div",{class:"code-block-filename"},"docker.yaml"),e("code",{class:"language-yaml"},[e("span",{class:"token key atrule"},"users"),e("span",{class:"token punctuation"},":"),s(`
  `),e("span",{class:"token punctuation"},"-"),s(),e("span",{class:"token key atrule"},"name"),e("span",{class:"token punctuation"},":"),s(` ubuntu
    `),e("span",{class:"token key atrule"},"sudo"),e("span",{class:"token punctuation"},":"),s(" ALL=(ALL) NOPASSWD"),e("span",{class:"token punctuation"},":"),s(`ALL
    `),e("span",{class:"token key atrule"},"ssh-authorized-keys"),e("span",{class:"token punctuation"},":"),s(`
      `),e("span",{class:"token punctuation"},"-"),s(" your"),e("span",{class:"token punctuation"},"-"),s("ssh"),e("span",{class:"token punctuation"},"-"),s("public"),e("span",{class:"token punctuation"},"-"),s(`key
`),e("span",{class:"token key atrule"},"package_uplang"),e("span",{class:"token punctuation"},":"),s(" zh"),e("span",{class:"token punctuation"},"-"),s(`TW
`),e("span",{class:"token key atrule"},"date"),e("span",{class:"token punctuation"},":"),s(),e("span",{class:"token boolean important"},"true"),s(`
`),e("span",{class:"token key atrule"},"packages"),e("span",{class:"token punctuation"},":"),s(`
  `),e("span",{class:"token punctuation"},"-"),s(` docker
  `),e("span",{class:"token punctuation"},"-"),s(" avahi"),e("span",{class:"token punctuation"},"-"),s(`daemon
  `),e("span",{class:"token punctuation"},"-"),s(" apt"),e("span",{class:"token punctuation"},"-"),s("transport"),e("span",{class:"token punctuation"},"-"),s(`https
  `),e("span",{class:"token punctuation"},"-"),s(" ca"),e("span",{class:"token punctuation"},"-"),s(`certificates
  `),e("span",{class:"token punctuation"},"-"),s(` curl
  `),e("span",{class:"token punctuation"},"-"),s(` gnupg
  `),e("span",{class:"token punctuation"},"-"),s(" lsb"),e("span",{class:"token punctuation"},"-"),s(`release
`),e("span",{class:"token key atrule"},"runcmd"),e("span",{class:"token punctuation"},":"),s(`
  `),e("span",{class:"token punctuation"},"-"),s(" sudo curl "),e("span",{class:"token punctuation"},"-"),s("fsSL https"),e("span",{class:"token punctuation"},":"),s("//get.docker.com "),e("span",{class:"token punctuation"},"|"),s(` sudo bash
  `),e("span",{class:"token punctuation"},"-"),s(` sudo systemctl enable docker
  `),e("span",{class:"token punctuation"},"-"),s(" sudo systemctl enable "),e("span",{class:"token punctuation"},"-"),s(`s HUP ssh
  `),e("span",{class:"token punctuation"},"-"),s(` sudo groupadd docker
  `),e("span",{class:"token punctuation"},"-"),s(" sudo usermod "),e("span",{class:"token punctuation"},"-"),s(`aG docker ubuntu
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Then run this command to create a Ubuntu VM"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[s("multipass launch -c "),e("span",{class:"token number"},"2"),s(" -m 1G -d 5G -n docker "),e("span",{class:"token number"},"20.10"),s(` --cloud-init docker.yaml
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"This will take a few mins to build and start. Once it\u2019s done you can see what is running with"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},`multipass list
`)]),e("h3",{id:"connect-to-vm",tabindex:"-1",class:"text-xl font-semibold mt-1.6em mb-0.6em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#connect-to-vm","aria-hidden":"true"},"#"),s(" Connect to VM")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"SSH into docker VM"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[e("span",{class:"token function"},"ssh"),s(` ubuntu@docker.local
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Makesure you accepted VM to save you SSH key, this is required for docker to auto connect to remote docker engian."),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Also check is docker installed on VM by running"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},`docker info
`)]),e("h3",{id:"setup-docker-host",tabindex:"-1",class:"text-xl font-semibold mt-1.6em mb-0.6em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#setup-docker-host","aria-hidden":"true"},"#"),s(" Setup docker host")]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},[s("Add this to your "),e("code",null,"~/.zprofile"),s(" to always use this "),e("code",null,"DOCKER_HOST")]),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[e("span",{class:"token builtin class-name"},"export"),s(),e("span",{class:"token assign-left variable"},"DOCKER_HOST"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"ssh://ubuntu@docker.local"'),s(`
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Apply changes"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[e("span",{class:"token builtin class-name"},"source"),s(` ~/.zprofile
`)])]),e("p",{class:"my-1.25em last:mt-0 first:mb-0 leading-[1.75]"},"Check docker info"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},`docker info
`)]),e("h3",{id:"reference",tabindex:"-1",class:"text-xl font-semibold mt-1.6em mb-0.6em next:mt-0"},[e("a",{class:"header-anchor text-sky-500 dark:text-sky-400 font-medium hover:underline",href:"#reference","aria-hidden":"true"},"#"),s(" Reference")]),e("ul",{class:"my-1.25em list-disc list-inside px-2"},[e("li",{class:"my-0.5em"},[e("a",{href:"https://www.jimhribar.com/replace-docker-desktop-with-ubuntu-multipass/",class:"text-sky-500 dark:text-sky-400 font-medium hover:underline",target:"_blank",rel:"noopener"},"How to Replace Docker Desktop with Ubuntu Multipass")]),e("li",{class:"my-0.5em"},[e("a",{href:"https://medium.com/@gourneau/docker-engine-with-multipass-on-macos-9d22b8ade35c",class:"text-sky-500 dark:text-sky-400 font-medium hover:underline",target:"_blank",rel:"noopener"},"Docker Engine with multipass on macOS")]),e("li",{class:"my-0.5em"},[e("a",{href:"https://blog.mikesir87.io/2019/08/using-ssh-connections-in-docker-contexts/",class:"text-sky-500 dark:text-sky-400 font-medium hover:underline",target:"_blank",rel:"noopener"},"Using SSH Connections in Docker Contexts")])])],-1),b={setup(u,{expose:t}){const a={title:"Replace Docker Desktop with Multipass",author:"hanlee",type:"post",lang:"en-US",date:"2021-09-28T18:59:14.000Z",description:"How to prevent Docker Desktop taken a lot resource from my Mac.",image:"/images/2021/No-Docker-Desktop.png",categories:["Docker"],tags:["Docker","Docker Desktop","Multipass","Mac"]};return t({frontmatter:a}),(m,p)=>{const n=o;return r(),l(n,{frontmatter:a},{default:c(()=>[i]),_:1})}}};export{b as default};
